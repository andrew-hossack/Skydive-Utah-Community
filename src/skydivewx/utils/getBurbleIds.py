import aiohttp
import asyncio
from bs4 import BeautifulSoup
import re


async def fetch(session, url, i):
    async with session.get(url) as response:
        return i, await response.text()


async def get_dz_name_id():
    urls = [f"https://dzm.burblesoft.com/jmp?dz_id={i}" for i in range(50000)]
    dz_list = []
    async with aiohttp.ClientSession() as session:
        tasks = []
        for i, url in enumerate(urls):
            tasks.append(fetch(session, url, i))

        pages_content = await asyncio.gather(*tasks)

        for i, content in pages_content:
            soup = BeautifulSoup(content, "html.parser")
            scripts = soup.find_all("script")
            for script in scripts:
                if script.string is not None and "dz_id" in script.string:
                    match_dz_id = re.search(r"dz_id\s*:\s*(\d+),", script.string)
                    match_dz_name = re.search(
                        r"dz_name\s*:\s*\'([^\']*)\',", script.string
                    )
                    if match_dz_id and match_dz_name:
                        dz_id = match_dz_id.group(1)
                        dz_name = match_dz_name.group(1)
                        dz_list.append({"dz_id": dz_id, "dz_name": dz_name})
    return dz_list


results = asyncio.run(get_dz_name_id())
print(results)


print(len(results))

# res=[{'dz_id': '7', 'dz_name': 'Skydive Tecumseh'}, {'dz_id': '10', 'dz_name': 'Sample Dropzone'}, {'dz_id': '11', 'dz_name': 'Skydive Alabama'}, {'dz_id': '15', 'dz_name': 'Skydive Tennessee'}, {'dz_id': '18', 'dz_name': 'Skydive Georgia'}, {'dz_id': '27', 'dz_name': 'Skydive Chicago'}, {'dz_id': '36', 'dz_name': 'Skydive Indianapolis'}, {'dz_id': '43', 'dz_name': 'Wisconsin Skydiving Center'}, {'dz_id': '47', 'dz_name': 'Des Moines Skydivers'}, {'dz_id': '48', 'dz_name': 'Skydive the Wasatch'}, {'dz_id': '51', 'dz_name': 'Skydive Philadelphia'}, {'dz_id': '53', 'dz_name': 'Skydive City Zephyrhills'}, {'dz_id': '57', 'dz_name': 'Skydive Sussex'}, {'dz_id': '70', 'dz_name': 'Start Skydiving, LLC'}, {'dz_id': '74', 'dz_name': 'Alaska Skydive Center'}, {'dz_id': '99', 'dz_name': 'Skydive Perris'}, {'dz_id': '125', 'dz_name': 'Skydive Paraclete XP'}, {'dz_id': '178', 'dz_name': 'Dropzone Denmark'}, {'dz_id': '189', 'dz_name': 'Skydive Elsinore'}, {'dz_id': '193', 'dz_name': 'Skydive Jurien Bay'}, {'dz_id': '203', 'dz_name': 'Parachutisme Adrénaline'}, {'dz_id': '204', 'dz_name': 'SA Skydiving Ops'}, {'dz_id': '207', 'dz_name': 'Parachute 3R-Victo'}, {'dz_id': '208', 'dz_name': 'Music City Skydiving'}, {'dz_id': '215', 'dz_name': 'Parachute GO Skydive'}, {'dz_id': '223', 'dz_name': 'Skydive Operations Demo'}, {'dz_id': '230', 'dz_name': 'JumpTN'}, {'dz_id': '256', 'dz_name': 'Skydive Carolina'}, {'dz_id': '257', 'dz_name': 'WNYSkydiving'}, {'dz_id': '261', 'dz_name': 'Skydive Monroe'}, {'dz_id': '273', 'dz_name': 'Skydive Allegan'}, {'dz_id': '292', 'dz_name': 'Piedmont Skydiving'}, {'dz_id': '298', 'dz_name': 'Skydive Moncton'}, {'dz_id': '317', 'dz_name': 'Fyrosity®'}, {'dz_id': '329', 'dz_name': 'Skydive Andes Chile'}, {'dz_id': '339', 'dz_name': 'DEMO: APF Demo'}, {'dz_id': '348', 'dz_name': 'Cadence Sky Sports'}, {'dz_id': '352', 'dz_name': 'Skydive Gananoque'}, {'dz_id': '359', 'dz_name': 'Skydive Midwest'}, {'dz_id': '371', 'dz_name': 'Pepes Island Boogie'}, {'dz_id': '385', 'dz_name': 'Skydive Utah'}, {'dz_id': '390', 'dz_name': 'Skydive Orange'}, {'dz_id': '392', 'dz_name': 'Adelaide Tandem Skydiving Pty Ltd'}, {'dz_id': '396', 'dz_name': 'Skydive Sebastian'}, {'dz_id': '398', 'dz_name': 'Skydive Netheravon'}, {'dz_id': '399', 'dz_name': 'Skydive Central North Carolina'}, {'dz_id': '408', 'dz_name': 'CSC'}, {'dz_id': '409', 'dz_name': 'Skydive Parys'}, {'dz_id': '416', 'dz_name': 'Skydive Twin Cities'}, {'dz_id': '417', 'dz_name': 'Jumptown'}, {'dz_id': '419', 'dz_name': 'Skydive Cincinnati'}, {'dz_id': '531', 'dz_name': 'Skydive Langar'}, {'dz_id': '551', 'dz_name': 'Skydive Tønsberg'}, {'dz_id': '561', 'dz_name': 'Skydive Cross Keys'}, {'dz_id': '621', 'dz_name': 'SkydiveKC'}, {'dz_id': '731', 'dz_name': 'DZONE® - BOISE'}, {'dz_id': '861', 'dz_name': 'Skydive The Rock'}, {'dz_id': '871', 'dz_name': 'DZONE® BOZEMAN'}, {'dz_id': '911', 'dz_name': 'Skydive Fargo'}, {'dz_id': '1111', 'dz_name': 'Skydive Toronto Inc'}, {'dz_id': '1141', 'dz_name': 'Aarhus Faldskærms Club'}, {'dz_id': '1311', 'dz_name': 'Ozarks Skydive Center'}, {'dz_id': '1421', 'dz_name': 'Skydive Suffolk'}, {'dz_id': '1911', 'dz_name': 'Skydive Voss'}, {'dz_id': '2023', 'dz_name': 'Blue Sky Ranch'}, {'dz_id': '2133', 'dz_name': 'Skydive Panama City'}, {'dz_id': '2251', 'dz_name': 'Beach SkyTime Castellón'}, {'dz_id': '2271', 'dz_name': 'Dallas Skydive Center'}, {'dz_id': '2351', 'dz_name': 'Skydive Spain'}, {'dz_id': '2401', 'dz_name': 'Texas Skydiving'}, {'dz_id': '2521', 'dz_name': 'Skydive Coastal Carolinas'}, {'dz_id': '2581', 'dz_name': 'Aversi Faldskærms Club'}, {'dz_id': '2661', 'dz_name': 'Skydive West Plains'}, {'dz_id': '2921', 'dz_name': 'Skydive New England'}, {'dz_id': '2933', 'dz_name': 'Skydive Hibaldstow'}, {'dz_id': '2943', 'dz_name': 'SkyDance SkyDiving'}, {'dz_id': '2973', 'dz_name': 'Canton Air Sports'}, {'dz_id': '2993', 'dz_name': 'Bay Area Skydiving'}, {'dz_id': '3113', 'dz_name': 'Midwest Freefall SPC Inc.'}, {'dz_id': '3293', 'dz_name': 'Skydive Pennsylvania'}, {'dz_id': '3373', 'dz_name': 'Skydive Sweden'}, {'dz_id': '3393', 'dz_name': 'Skydive San Diego'}, {'dz_id': '3451', 'dz_name': 'Skydive the Ranch School'}, {'dz_id': '3481', 'dz_name': 'Cleveland Skydiving Center'}, {'dz_id': '3563', 'dz_name': 'Skydive Houston'}, {'dz_id': '3773', 'dz_name': 'Skydive California'}, {'dz_id': '3911', 'dz_name': 'Skydive Algarve'}, {'dz_id': '3993', 'dz_name': 'Skydive Flanders - Zwartberg'}, {'dz_id': '4043', 'dz_name': 'Paracentrum Texel'}, {'dz_id': '4661', 'dz_name': 'Skydive Danielson'}, {'dz_id': '4671', 'dz_name': 'Odense Faldskærmscenter'}, {'dz_id': '4741', 'dz_name': 'Skydive Oz'}, {'dz_id': '4763', 'dz_name': 'Silicon Valley Skydive'}, {'dz_id': '4843', 'dz_name': 'Skydive Puerto Rico'}, {'dz_id': '4985', 'dz_name': 'Skydive Adventures'}, {'dz_id': '4995', 'dz_name': 'Alberta Skydive Central'}, {'dz_id': '5215', 'dz_name': 'Skydive Flanders - Schaffen'}, {'dz_id': '5225', 'dz_name': 'Skydive Flanders - Moorsele'}, {'dz_id': '5255', 'dz_name': 'Skydive Shenandoah'}, {'dz_id': '5415', 'dz_name': 'AerOhio Skydiving'}, {'dz_id': '5445', 'dz_name': 'Edmonton Skydive'}, {'dz_id': '5854', 'dz_name': 'Skydive Zeeland'}, {'dz_id': '5932', 'dz_name': 'Virginia Skydiving Center'}, {'dz_id': '6064', 'dz_name': 'Nordjysk Faldskærmsklub'}, {'dz_id': '6123', 'dz_name': 'Eugene Skydivers'}, {'dz_id': '6124', 'dz_name': 'Skydive Ameland'}, {'dz_id': '6184', 'dz_name': 'Tessel Air'}, {'dz_id': '6393', 'dz_name': 'Kuwait Skydive & Fly'}, {'dz_id': '6444', 'dz_name': 'Skydive Skåne'}, {'dz_id': '6544', 'dz_name': 'Skydive Rotterdam “The Flying Dutchmen”'}, {'dz_id': '6673', 'dz_name': 'Skydive Atlanta'}, {'dz_id': '6693', 'dz_name': 'Skydive Viken'}, {'dz_id': '6743', 'dz_name': 'Lincoln Sport Parachute Club'}, {'dz_id': '6784', 'dz_name': 'Prostipad'}, {'dz_id': '6791', 'dz_name': 'Skydive Extreme Calgary'}, {'dz_id': '6891', 'dz_name': 'Skydive the Falls'}, {'dz_id': '6971', 'dz_name': 'Skydive Taft'}, {'dz_id': '7031', 'dz_name': 'Skydive Greene County'}, {'dz_id': '7131', 'dz_name': 'Abu Dhabi Skydive'}, {'dz_id': '7201', 'dz_name': 'Skydive Viborg'}, {'dz_id': '7271', 'dz_name': 'Skydive Thailand'}, {'dz_id': '7311', 'dz_name': 'Skydive Dubai Desert Dropzone'}, {'dz_id': '7331', 'dz_name': 'Skydive Dubai Palm'}, {'dz_id': '7371', 'dz_name': 'Skyhub Gyrocopter'}, {'dz_id': '7381', 'dz_name': 'Skydive Mountaineer'}, {'dz_id': '7411', 'dz_name': 'Crystal Coast Skydiving LLC'}, {'dz_id': '8071', 'dz_name': 'Capital City Skydiving'}, {'dz_id': '8081', 'dz_name': 'Skydive Charlevoix'}, {'dz_id': '8082', 'dz_name': 'deserttest'}, {'dz_id': '8092', 'dz_name': 'palmtest'}, {'dz_id': '8101', 'dz_name': 'Revolution Flight'}, {'dz_id': '8111', 'dz_name': 'Skydive Pretoria'}, {'dz_id': '8131', 'dz_name': 'Homestead'}, {'dz_id': '8144', 'dz_name': 'Skydive GB Parachute Club'}, {'dz_id': '8154', 'dz_name': 'Sibson Skydivers'}, {'dz_id': '8171', 'dz_name': 'Skydive STL'}, {'dz_id': '8281', 'dz_name': 'Skydive the Gulf'}, {'dz_id': '8301', 'dz_name': 'Boston Skydive Company'}, {'dz_id': '8351', 'dz_name': 'DC Skydiving Center'}, {'dz_id': '8361', 'dz_name': 'Niagara Skydive Centre'}, {'dz_id': '8411', 'dz_name': 'Dallas Tandem Skydiving'}, {'dz_id': '8421', 'dz_name': 'Skydive Coastal California'}, {'dz_id': '8461', 'dz_name': 'Pacific Northwest Skydiving Center'}, {'dz_id': '8494', 'dz_name': 'Beccles Skydivers'}, {'dz_id': '8551', 'dz_name': 'Out of the Blue Skydiving'}, {'dz_id': '8671', 'dz_name': 'Phoenix Area Skydiving'}, {'dz_id': '8681', 'dz_name': 'Skydive Center San Antonio'}, {'dz_id': '8691', 'dz_name': 'Skydive the Beach Jacksonville'}, {'dz_id': '8754', 'dz_name': 'SkyDive Warszawa'}, {'dz_id': '8991', 'dz_name': 'Executive Airport'}, {'dz_id': '9094', 'dz_name': 'Skydive Oslo'}, {'dz_id': '9134', 'dz_name': 'Black Knights Parachute Centre'}, {'dz_id': '9401', 'dz_name': 'Parachute Ottawa'}, {'dz_id': '10004', 'dz_name': 'Skydive Bjorli Tønsberg'}, {'dz_id': '10341', 'dz_name': 'Test dropzone'}, {'dz_id': '10381', 'dz_name': 'Flying-Devil'}, {'dz_id': '10471', 'dz_name': 'Rochester Skydivers'}, {'dz_id': '10571', 'dz_name': 'Deep Dive Dubai'}, {'dz_id': '10631', 'dz_name': 'New York Tandem Skydiving'}, {'dz_id': '10654', 'dz_name': 'Commando Skydivers Club'}, {'dz_id': '10671', 'dz_name': 'Fly Seychelles Skydiving Center'}, {'dz_id': '10761', 'dz_name': 'Faldskærmsklubben.DK'}, {'dz_id': '10864', 'dz_name': 'Skydive Ireland'}, {'dz_id': '11021', 'dz_name': 'Faldskærmsklubben Nordenfjords'}, {'dz_id': '11051', 'dz_name': 'Saltamos.es (SkydiveBCN)'}, {'dz_id': '11491', 'dz_name': 'Skydive Finland'}, {'dz_id': '11551', 'dz_name': 'YUU Skydive'}, {'dz_id': '11621', 'dz_name': 'Elevation BCN'}, {'dz_id': '11651', 'dz_name': 'Skydive Milwaukee / Sky Knights SPC'}, {'dz_id': '11711', 'dz_name': 'Xline'}, {'dz_id': '11721', 'dz_name': 'Inflight'}, {'dz_id': '11731', 'dz_name': 'Parachute Montréal Rive-Nord'}, {'dz_id': '11741', 'dz_name': 'Parachute Montréal Rive-Sud'}, {'dz_id': '11774', 'dz_name': 'Far North Freefall'}, {'dz_id': '11984', 'dz_name': 'Skydive Oppdal'}, {'dz_id': '12031', 'dz_name': 'Jump Omaha Skydiving'}, {'dz_id': '12061', 'dz_name': 'Skydive Mountain City'}, {'dz_id': '12111', 'dz_name': 'Paradise Valley Skydiving'}, {'dz_id': '12231', 'dz_name': 'Husein Test Dropzone'}, {'dz_id': '12234', 'dz_name': 'Husein dev dropzone'}, {'dz_id': '12251', 'dz_name': 'Skydive NEPA'}, {'dz_id': '12381', 'dz_name': 'ACTION FLIGHT AVIATION LLC - Aerobatic Flights'}, {'dz_id': '12431', 'dz_name': 'Ultimate Skydiving Adventures'}, {'dz_id': '12441', 'dz_name': 'Boston Skydive Center'}, {'dz_id': '12571', 'dz_name': 'Parys'}, {'dz_id': '12661', 'dz_name': 'ACTION FLIGHT AVIATION LLC - Hot Air Balloon Flights'}, {'dz_id': '12671', 'dz_name': 'ACTION FLIGHT AVIATION LLC - Skydive'}, {'dz_id': '12691', 'dz_name': 'Skydive Windy City Chicago'}, {'dz_id': '12701', 'dz_name': 'XPark'}, {'dz_id': '12711', 'dz_name': 'USPA'}, {'dz_id': '12741', 'dz_name': 'Jump Pilot Academy℠'}, {'dz_id': '12791', 'dz_name': 'Skydive Siquijor'}, {'dz_id': '12991', 'dz_name': 'Nordsjællands Faldskærms Klub'}, {'dz_id': '13011', 'dz_name': 'Skydive SWOOP'}, {'dz_id': '13014', 'dz_name': 'Skydive Dubai Special Projects'}, {'dz_id': '13071', 'dz_name': 'The Skydive School'}, {'dz_id': '13261', 'dz_name': 'Skydive Northstar LLC'}, {'dz_id': '13298', 'dz_name': 'Grenland Fallskjermklubb'}, {'dz_id': '13398', 'dz_name': 'Eagle Skydive'}, {'dz_id': '13446', 'dz_name': 'Gateway 2023'}, {'dz_id': '13566', 'dz_name': 'Brasil Paraquedismo'}, {'dz_id': '13576', 'dz_name': 'PARACAIDISMO SANTA FE'}]
